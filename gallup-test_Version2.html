<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì—ç–ª–ª–∞–ø –≠–∫—Å–ø—Ä–µ—Å—Å-–¢–µ—Å—Ç</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: Inter, UI-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background: #f3f4f6; padding: 10px; }
        .card { background: white; border-radius: 15px; padding: 20px; max-width: 520px; margin: auto; box-shadow: 0 6px 18px rgba(0,0,0,0.08); }
        .btn { width: 100%; text-align: left; padding: 14px; border: 1px solid #e6e6ef; border-radius: 10px; margin-bottom: 10px; background: #fff; cursor: pointer; font-size: 15px; }
        .btn:hover { background: #fafafa; border-color: #6366f1; }
        .btn:focus { outline: 3px solid rgba(99,102,241,0.15); }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .progress { height: 8px; background: #eee; border-radius: 10px; margin-bottom: 12px; overflow: hidden; }
        .fill { height: 100%; background: #6366f1; width: 0%; transition: width 0.35s ease; }
        .hidden { display: none; }
        .meta { color: #6b7280; font-size: 13px; margin-bottom: 8px; }
        .muted { color:#6b7280; }
        .actions { display: grid; gap: 10px; margin-top: 12px; }
    </style>
</head>
<body>
    <div class="card" role="main" aria-labelledby="title">
        <div id="start" role="region" aria-label="–°—Ç–∞—Ä—Ç" >
            <h1 id="title" class="text-2xl font-bold mb-2">üåø –ì—ç–ª–ª–∞–ø-—Ç–µ—Å—Ç</h1>
            <p class="mb-6 muted">–£–∑–Ω–∞–π—Ç–µ —Å–≤–æ–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∑–∞ 2 –º–∏–Ω—É—Ç—ã.</p>
            <button id="startBtn" onclick="begin()" class="w-full bg-indigo-600 text-white p-4 rounded-lg font-bold" aria-label="–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç">–ù–∞—á–∞—Ç—å</button>
        </div>

        <div id="quiz" class="hidden" role="region" aria-live="polite" aria-atomic="true">
            <div class="meta" id="progressText">–í–æ–ø—Ä–æ—Å 0/0</div>
            <div class="progress" aria-hidden="true"><div id="bar" class="fill"></div></div>
            <h2 id="qtext" class="text-lg font-bold mb-4"></h2>
            <div id="options" aria-label="–í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤" ></div>
        </div>

        <div id="res" class="hidden" role="region" aria-live="polite">
            <h2 id="rtitle" class="text-xl font-bold mb-2"></h2>
            <p id="rdesc" class="mb-6 text-gray-600"></p>
            <div class="border-t pt-4">
                <p class="font-bold mb-4">–ß—Ç–æ –¥–∞–ª—å—à–µ?</p>
                <div class="actions">
                    <button onclick="go('only')" class="btn" aria-label="–¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç">1. –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç</button>
                    <button onclick="go('expert')" class="btn" aria-label="–¢–µ—Å—Ç –ø–ª—é—Å —Ä–∞–∑–±–æ—Ä">2. –¢–µ—Å—Ç + —Ä–∞–∑–±–æ—Ä üî•</button>
                    <button onclick="go('tg')" class="btn text-sm" aria-label="–ß–∏—Ç–∞—Ç—å –∫–µ–π—Å—ã">3. –ü–æ—á–∏—Ç–∞—Ç—å –∫–µ–π—Å—ã</button>
                </div>
            </div>
        </div>

        <div id="final" class="hidden text-center" role="region" aria-live="polite">
            <p id="fmsg" class="mb-4"></p>
            <a id="flink" href="#" target="_blank" rel="noopener noreferrer" class="block w-full bg-indigo-600 text-white p-4 rounded-lg font-bold text-center mb-3">–ü–µ—Ä–µ–π—Ç–∏</a>
            <div class="flex gap-2">
                <button id="retry" onclick="resetQuiz()" class="btn" aria-label="–ü—Ä–æ–π—Ç–∏ —Å–Ω–æ–≤–∞">–ü—Ä–æ–π—Ç–∏ —Å–Ω–æ–≤–∞</button>
            </div>
        </div>
    </div>

    <script>
        const qs = [
            {q:"–° —á–µ–≥–æ –Ω–∞—á–Ω–µ—à—å –¥–µ–Ω—å?", a:"–ü–ª–∞–Ω –≤ –±–ª–æ–∫–Ω–æ—Ç–µ", b:"–û–±—â–µ–Ω–∏–µ —Å –ª—é–¥—å–º–∏", c:"–ó–∞–±–æ—Ç–∞ –æ –±–ª–∏–∑–∫–∏—Ö", d:"–†–∞–∑–º—ã—à–ª–µ–Ω–∏—è –æ –±—É–¥—É—â–µ–º"},
            {q:"–ö–∞–∫ —Ä–µ—à–∏—à—å, —á–µ–º –∑–∞–Ω—è—Ç—å—Å—è –≤–µ—á–µ—Ä–æ–º?", a:"–ü—Ä–µ–¥–ª–æ–∂—É —á–µ—Ç–∫–∏–π –ø–ª–∞–Ω", b:"–ë—É–¥—É –∞–∫—Ç–∏–≤–Ω–æ —É–±–µ–∂–¥–∞—Ç—å", c:"–£—á—Ç—É –º–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ", d:"–í–∑–≤–µ—à—É –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã"},
            {q:"–ü–µ—Ä–≤—ã–π —à–∞–≥ –∫ –Ω–æ–≤–æ–π —Ü–µ–ª–∏?", a:"–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á", b:"–†–∞—Å—Å–∫–∞–∂—É –≤—Å–µ–º", c:"–ü–æ–¥—É–º–∞—é –æ —Å–µ–º—å–µ", d:"–ü—Ä–æ–¥—É–º–∞—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é"},
            {q:"–°–≤–æ–±–æ–¥–Ω—ã–π —á–∞—Å. –ß—Ç–æ —Å–¥–µ–ª–∞–µ—à—å?", a:"–ù–∞–≤–µ–¥—É –ø–æ—Ä—è–¥–æ–∫", b:"–ü–æ–∑–≤–æ–Ω—é –¥—Ä—É–≥—É", c:"–ü–æ–±—É–¥—É —Å —Ä–æ–¥–Ω—ã–º–∏", d:"–ü–æ–¥—É–º–∞—é –æ –ø–ª–∞–Ω–∞—Ö"},
            {q:"–°–ø–æ—Ä –≤ –∫–æ–º–∞–Ω–¥–µ. –¢–≤–æ—è —Ä–æ–ª—å?", a:"–£—Å—Ç–∞–Ω–æ–≤–ª—é –ø—Ä–∞–≤–∏–ª–∞", b:"–î–æ–∫–∞–∂—É —Å–≤–æ—é –ø—Ä–∞–≤–æ—Ç–µ", c:"–ü–æ–º–∏—Ä—é –≤—Å–µ—Ö", d:"–ù–∞–π–¥—É –æ–±—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ"},
            {q:"–ß—Ç–æ –ø—Ä–∏—è—Ç–Ω–µ–µ —Å–ª—ã—à–∞—Ç—å?", a:"–¢—ã –Ω–∞–¥–µ–∂–Ω—ã–π —á–µ–ª–æ–≤–µ–∫", b:"–¢—ã –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—à—å", c:"–° —Ç–æ–±–æ–π —É—é—Ç–Ω–æ", d:"–¢—ã –≤–∏–¥–∏—à—å —Å—É—Ç—å"},
            {q:"–ì–ª–∞–≤–Ω–æ–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ?", a:"–°—Ä–æ–∫–∏ –∏ –ø–æ—Ä—è–¥–æ–∫", b:"–≠–Ω–µ—Ä–≥–∏—è –∫–æ–º–∞–Ω–¥—ã", c:"–î–æ–≤–µ—Ä–∏–µ –ª—é–¥–µ–π", d:"–°–º—ã—Å–ª –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è"},
            {q:"–í—Å—Ç—Ä–µ—Ç–∏–ª –∑–Ω–∞–∫–æ–º–æ–≥–æ. –ß—Ç–æ —Å–¥–µ–ª–∞–µ—à—å?", a:"–ö–∏–≤–Ω—É –∏ –ø–æ–π–¥—É –¥–∞–ª—å—à–µ", b:"–ó–∞–≤–µ–¥—É —Ä–∞–∑–≥–æ–≤–æ—Ä", c:"–°–ø—Ä–æ—à—É –∫–∞–∫ –¥–µ–ª–∞", d:"–ó–∞–º–µ—á—É –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–π"},
            {q:"–ù–æ–≤–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å. –†–µ–∞–∫—Ü–∏—è?", a:"–°–æ—Å—Ç–∞–≤–ª—é –≥—Ä–∞—Ñ–∏–∫", b:"–ü–æ–¥–µ–ª—é—Å—å —Ä–∞–¥–æ—Å—Ç—å—é", c:"–°–ø—Ä–æ—à—É —Å–æ–≤–µ—Ç–∞ —Å–µ–º—å–∏", d:"–û—Ü–µ–Ω—é –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã"},
            {q:"–£ –¥—Ä—É–≥–∞ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è. –ü–æ–º–æ—â—å?", a:"–°–¥–µ–ª–∞—é –≤–º–µ—Å—Ç–µ —Å –Ω–∏–º", b:"–ü–æ–¥–±–æ–¥—Ä—é —Å–ª–æ–≤–∞–º–∏", c:"–ü—Ä–æ—Å—Ç–æ –≤—ã—Å–ª—É—à–∞—é", d:"–î–∞–º –Ω–æ–≤—É—é –∏–¥–µ—é"}
        ];
        const rs = {
            a: {t:"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å", d:"–í—ã —á–µ–ª–æ–≤–µ–∫ –¥–µ–ª–∞. –í–∞—à–∞ —Å–∏–ª–∞ ‚Äî –≤ –ø–æ—Ä—è–¥–∫–µ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ."},
            b: {t:"–í–ª–∏—è–Ω–∏–µ", d:"–í—ã –ª–∏–¥–µ—Ä. –í–∞—à–∞ —Å–∏–ª–∞ ‚Äî –≤ —É–º–µ–Ω–∏–∏ –∑–∞–∂–∏–≥–∞—Ç—å –∏ –≤–µ—Å—Ç–∏ –∑–∞ —Å–æ–±–æ–π."},
            c: {t:"–û—Ç–Ω–æ—à–µ–Ω–∏—è", d:"–í—ã –¥—É—à–∞ –∫–æ–º–∞–Ω–¥—ã. –í–∞—à–∞ —Å–∏–ª–∞ ‚Äî –≤ –∏—Å–∫—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –∑–∞–±–æ—Ç–µ."},
            d: {t:"–°—Ç—Ä–∞—Ç–µ–≥", d:"–í—ã –º—ã—Å–ª–∏—Ç–µ–ª—å. –í–∞—à–∞ —Å–∏–ª–∞ ‚Äî –≤ –≤–∏–¥–µ–Ω–∏–∏ –±—É–¥—É—â–µ–≥–æ –∏ –∞–Ω–∞–ª–∏–∑–µ."}
        };

        let cur = 0;
        let sc = {a:0, b:0, c:0, d:0};
        let locked = false;

        // Begin ‚Äî show start screen -> quiz
        function begin() {
            resetScores();
            document.getElementById('start').classList.add('hidden');
            document.getElementById('final').classList.add('hidden');
            document.getElementById('res').classList.add('hidden');
            document.getElementById('quiz').classList.remove('hidden');
            cur = 0;
            show();
        }

        function resetScores() {
            sc = {a:0, b:0, c:0, d:0};
            locked = false;
            document.getElementById('bar').style.width = '0%';
        }

        function show() {
            const total = qs.length;
            // question counter (numbered from 1)
            document.getElementById('progressText').innerText = `–í–æ–ø—Ä–æ—Å ${Math.min(cur+1, total)}/${total}`;
            document.getElementById('qtext').innerText = qs[cur].q;
            document.getElementById('bar').style.width = (cur / qs.length * 100) + '%';

            const opt = document.getElementById('options');
            opt.innerHTML = '';
            locked = false;

            const letters = ['a','b','c','d'];
            letters.forEach((l, i) => {
                const b = document.createElement('button');
                b.className = 'btn';
                b.innerText = qs[cur][l];
                b.setAttribute('data-choice', l);
                b.setAttribute('aria-label', `–í–∞—Ä–∏–∞–Ω—Ç ${i+1}: ${qs[cur][l]}`);
                b.onclick = () => selectOption(l);
                b.onkeydown = (e) => {
                    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); selectOption(l); }
                };
                opt.appendChild(b);
            });

            // focus first option for keyboard users
            const first = opt.querySelector('button');
            if (first) first.focus();
        }

        function selectOption(letter) {
            if (locked) return;
            locked = true;

            // disable buttons immediately to prevent double clicks
            document.querySelectorAll('#options button').forEach(btn => btn.disabled = true);

            // increment score for letter
            if (sc.hasOwnProperty(letter)) sc[letter]++;

            // advance
            cur++;
            // if there are remaining questions, show next after a tiny delay for UX
            if (cur < qs.length) {
                // small delay to allow bar animation to show progress
                setTimeout(() => {
                    show();
                }, 180);
            } else {
                // finished
                // set bar to 100% then show results
                document.getElementById('bar').style.width = '100%';
                setTimeout(finish, 220);
            }
        }

        function finish() {
            document.getElementById('quiz').classList.add('hidden');
            document.getElementById('res').classList.remove('hidden');

            // Find winners (allow ties)
            let m = -1;
            for (let k in sc) if (sc[k] > m) m = sc[k];
            const winners = Object.keys(sc).filter(k => sc[k] === m);

            if (winners.length === 1) {
                const win = winners[0];
                document.getElementById('rtitle').innerText = rs[win].t;
                document.getElementById('rdesc').innerText = rs[win].d;
            } else {
                // Compose combined result
                const titles = winners.map(k => rs[k].t).join(', ');
                const descs = winners.map(k => rs[k].d);
                document.getElementById('rtitle').innerText = `–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã: ${titles}`;
                // join descriptions with separators
                document.getElementById('rdesc').innerText = descs.join(' ');
            }
        }

        function go(t) {
            document.getElementById('res').classList.add('hidden');
            document.getElementById('final').classList.remove('hidden');
            const ig = "https://www.instagram.com/marina_merjoeva";
            const tg = "https://t.me/your_channel";
            if (t === 'only') {
                document.getElementById('fmsg').innerText = "–ù–∞–ø–∏—à–∏—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä—É: ¬´–•–û–ß–£ –¢–ï–°–¢¬ª";
                const a = document.getElementById('flink');
                a.href = ig; a.rel = "noopener noreferrer";
            } else if (t === 'expert') {
                document.getElementById('fmsg').innerText = "–ù–∞–ø–∏—à–∏—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä—É: ¬´–†–ê–ó–ë–û–†¬ª";
                const a = document.getElementById('flink');
                a.href = ig; a.rel = "noopener noreferrer";
            } else {
                document.getElementById('fmsg').innerText = "–ß–∏—Ç–∞–π—Ç–µ –∫–µ–π—Å—ã –≤ Telegram";
                const a = document.getElementById('flink');
                a.href = tg; a.rel = "noopener noreferrer";
            }
        }

        function resetQuiz() {
            // show start screen to allow retake
            document.getElementById('final').classList.add('hidden');
            document.getElementById('res').classList.add('hidden');
            document.getElementById('quiz').classList.add('hidden');
            document.getElementById('start').classList.remove('hidden');
            resetScores();
        }

        // keyboard: allow 1-4 keys to choose answers while quiz visible
        window.addEventListener('keydown', (e) => {
            const quizVisible = !document.getElementById('quiz').classList.contains('hidden');
            if (!quizVisible) return;
            if (['1','2','3','4'].includes(e.key)) {
                const idx = parseInt(e.key, 10) - 1;
                const btns = Array.from(document.querySelectorAll('#options button'));
                if (btns[idx] && !btns[idx].disabled) {
                    btns[idx].click();
                    e.preventDefault();
                }
            }
        });

        // Safety: prevent accidental double submission on page unload (no network here, but good practice)
        window.addEventListener('beforeunload', (e) => {
            // no-op, placeholder for potential analytics / confirmation
        });

        // Expose some functions for testing in console
        window._gallup = { begin, resetQuiz, getScores: () => sc, getCurrent: () => cur };
    </script>
</body>
</html>